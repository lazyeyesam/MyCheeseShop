@inherits LayoutComponentBase
@layout MyCheeseShop.Components.Layout.MainLayout

@inject ShoppingCart ShoppingCart
@inject ProtectedSessionStorage ProtectedSessionStore

@Body

@code {

    protected async override Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender) return;

        var result = await ProtectedSessionStore.GetAsync<List<CartItem>>("cart");
        var items = result.Success ? result.Value : null;
        if (items is not null && items.Any())
            ShoppingCart.SetItems(items);
    }
}